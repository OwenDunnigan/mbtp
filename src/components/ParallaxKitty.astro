---
interface Props {
    bgImage: string;
    fgImage: string;
    alt: string;
    height?: string;
}

const { bgImage, fgImage, alt, height = "60vh" } = Astro.props;
---

<div class="image-container" style={`height: ${height};`}>
    <img class="layer-bg" src={bgImage} alt={`${alt} Background`} />
    <img class="layer-top" src={fgImage} alt={`${alt} Foreground`} />
</div>

<style lang="sass">
    .image-container
        position: relative
        width: 100%
        overflow: hidden
        display: flex
        justify-content: center
        align-items: center
        margin-bottom: 2rem

    img
        position: absolute
        top: 0
        left: 0
        width: 100%
        height: 100%
        object-fit: cover

    .layer-bg
        z-index: 1

    .layer-top
        z-index: 2
        transform-origin: center center
        will-change: transform
        transition: transform 0.1s linear
</style>

<script>
    // Select all instances of the top layer
    const layers = document.querySelectorAll(".layer-top");

    if (layers.length > 0) {
        window.addEventListener("scroll", () => {
            const scrollY = window.scrollY;
            const maxScroll = document.body.scrollHeight - window.innerHeight;
            // Prevent division by zero
            const scrollFraction = maxScroll > 0 ? scrollY / maxScroll : 0;

            // Scale from 1 to 1.5 based on scroll
            const scale = 1 + scrollFraction * 0.5;

            layers.forEach((layer) => {
                (layer as HTMLElement).style.transform = `scale(${scale})`;
            });
        });
    }
</script>
